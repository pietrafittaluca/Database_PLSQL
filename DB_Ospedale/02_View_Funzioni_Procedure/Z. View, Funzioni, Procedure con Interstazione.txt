--Funzioni

CREATE OR REPLACE FUNCTION num_int_eff_paz(CF_PAZX CHAR) RETURN NUMBER
--Numero di interventi effettuati sul paziente CF_PAZX

CREATE OR REPLACE FUNCTION end_int (ID_INT CHAR, DAT_EFF DATE, DUR NUMBER)
--Conclusione intervento

CREATE OR REPLACE FUNCTION COUNT_INT (CF_MED IN VARCHAR, DATE_INT DATE) RETURN INTEGER
--Funzione che conta quanti interventi sono assegnati ad un medico in una certa data

CREATE OR REPLACE FUNCTION GET_INF (DATA_INT IN DATE) RETURN INFERMIERE.CF_INF%TYPE
--Cerca gli infermieri che non sono mai stati assegnati ad un intervento
--Cerca gli infermieri liberi nella data e ora inserite e che non hanno assistito più di due interventi in quel giorno


--Procedure

CREATE OR REPLACE PROCEDURE PROGRAMMAZIONE_INTERVENTO (CF_MED IN VARCHAR, CF_PAZ IN VARCHAR, SALA_OP IN INTEGER, TIPO_INTERVENTO IN VARCHAR,
DURATA IN NUMBER, DATA_PREVISTA IN VARCHAR)
--Programmazione intervento

CREATE OR REPLACE PROCEDURE PRENOTA_VISITA (CF_PAZ IN VARCHAR, TIPO IN VARCHAR)
--Prenota Visita

CREATE OR REPLACE PROCEDURE prog_int_analisi (cf_med char, id_ric char, data_prev date, tipo varchar, durata_prev number, num_sala number)
--Se i valori di un’analisi sono minori di 40, si programma automaticamente un intervento.

CREATE OR REPLACE PROCEDURE try_dim (id_ric char, cod_dia number, mod_dim number)
--La dimissione può avvenire solo se tutti i valori dell'ultimo esame di un paziente sono maggiori di 60

CREATE OR REPLACE PROCEDURE cf_paz_da_nome(NOMEx VARCHAR)
--Visualizzare CF_PAZ e Cognome da un dato Nome

CREATE OR REPLACE PROCEDURE interventi_da_fare(CF_MEDx CHAR)
--Visualizzare gli interventi da fare di un medico e il nome del reparto del paziente

CREATE OR REPLACE PROCEDURE vis_paz_stanz_rep(NUMERO_S NUMBER,NOM_REP VARCHAR)
--Visualizzare il CF, nome, cognome e età dei pazienti in una stanza di un reparto

CREATE OR REPLACE PROCEDURE vis_analisi_paz(CF_PAZx CHAR)
--Visualizzazione delle analisi di un paziente

CREATE OR REPLACE PROCEDURE visualizza_int_paz(cf_pazx CHAR)
--Il paziente visualizza tutti i propri interventi

CREATE OR REPLACE PROCEDURE vis_foglio_fisio_e_esami_paz(cf_pazx CHAR)
--Visualizzare l'ultimo Foglio Fisioterapia e gli ultimi Esami di un paziente.

CREATE OR REPLACE PROCEDURE vis_esami_paz(cf_pazx CHAR)
--Visualizzare gli esami di un paziente.



--View
CREATE OR REPLACE VIEW visualizza_int_da_fare
--Visualizzare gli interventi da fare

CREATE OR REPLACE VIEW visualizza_ricoveri_ultima_settimana
--Visualizzare CF, NOME, COGNOME, REPARTO E DATA_RICOVERO dei pazienti per i ricoveri dell'ultima settimana

CREATE OR REPLACE VIEW vis_fogli_terapia
--Visualizzare i fogli fisioterapia di tutti i pazienti non ancora dimessi.
